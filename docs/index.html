<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Character Forge - Generador de Personajes y Bestiario</title>
    
    <!-- Fuentes Ã©picas -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Marck+Script&family=MedievalSharp&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- jsPDF para generar PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Ethers.js para NFTs (opcional) -->
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
</head>
<body>
    <!-- HEADER Ã‰PICO -->
    <header class="main-header">
        <div class="header-decoration">âš”ï¸</div>
        <div class="header-content">
            <h1 class="main-title">D&D Character Forge</h1>
            <p class="subtitle">Generador Ã‰pico de Personajes y Bestiario</p>
        </div>
        <div class="header-decoration">ğŸ‰</div>
    </header>

    <div class="container">
        
        <!-- SELECTOR DE EDICIÃ“N -->
        <section class="edition-selector">
            <label for="editionSelect">ğŸ“– EdiciÃ³n de D&D:</label>
            <select id="editionSelect">
                <option value="5e" selected>5ta EdiciÃ³n (2014)</option>
                <option value="3.5e">3.5 EdiciÃ³n (2003)</option>
                <option value="4e">4ta EdiciÃ³n (2008)</option>
            </select>
        </section>

        <!-- GENERADOR DE PERSONAJES -->
        <section class="generator-section">
            <h2 class="section-title">
                <span class="title-decoration">âš”ï¸</span>
                Generador de Personajes
                <span class="title-decoration">âš”ï¸</span>
            </h2>

            <div class="controls-grid">
                <button id="randomBtn" class="btn btn-primary btn-large">
                    ğŸ² Generar Personaje Aleatorio
                </button>
                
                <button id="toggleCustom" class="btn btn-secondary">
                    âš™ï¸ Personalizar Personaje
                </button>
            </div>

            <!-- Panel de personalizaciÃ³n (oculto inicialmente) -->
            <div id="customPanel" class="custom-panel hidden">
                <div class="custom-grid">
                    <div class="form-group">
                        <label for="charName">Nombre del Personaje:</label>
                        <input type="text" id="charName" placeholder="Ej: Thorin PuÃ±o de Hierro">
                    </div>

                    <div class="form-group">
                        <label for="raceSelect">Raza:</label>
                        <select id="raceSelect">
                            <option value="">Aleatorio</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="classSelect">Clase:</label>
                        <select id="classSelect">
                            <option value="">Aleatorio</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="backgroundSelect">Trasfondo:</label>
                        <select id="backgroundSelect">
                            <option value="">Aleatorio</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="alignmentSelect">Alineamiento:</label>
                        <select id="alignmentSelect">
                            <option value="">Aleatorio</option>
                        </select>
                    </div>
                </div>

                <button id="customGenerateBtn" class="btn btn-primary">
                    âœ¨ Generar Personaje Personalizado
                </button>
            </div>
        </section>

        <!-- FICHA DE PERSONAJE -->
        <div id="characterSheet" class="character-sheet hidden">
            <div class="sheet-decoration-top"></div>
            
            <!-- Header de ficha -->
            <div class="sheet-header">
                <div class="header-skulls">ğŸ’€ğŸ’€ğŸ’€</div>
                <h2 id="displayName" class="character-name">Nombre del Personaje</h2>
                <div class="character-subtitle">
                    <span id="displayRace">Raza</span>
                    <span class="separator">â€¢</span>
                    <span id="displayClass">Clase</span>
                    <span class="separator">â€¢</span>
                    <span>Nivel <span id="displayLevel">1</span></span>
                </div>
                <div class="character-meta">
                    <span id="displayBackground">Trasfondo</span>
                    <span class="separator">|</span>
                    <span id="displayAlignment">Alineamiento</span>
                </div>
            </div>

            <!-- Avatar y retrato -->
            <div class="character-visual">
                <div class="portrait-container">
                    <div class="portrait-frame">
                        <img id="aiPortrait" src="" alt="Retrato del personaje">
                        <button id="regenPortrait" class="regen-btn" title="Regenerar retrato">
                            ğŸ”„
                        </button>
                    </div>
                </div>

                <div class="avatar-container">
                    <div class="avatar-frame">
                        <svg id="charAvatar" viewBox="0 0 120 120"></svg>
                    </div>
                </div>
            </div>

            <!-- Power Level -->
            <div class="power-level-container">
                <div class="power-label">Poder del Personaje</div>
                <div id="powerBar" class="power-bar"></div>
                <div id="powerLevel" class="power-level-text">â­ Novato</div>
            </div>

            <!-- CaracterÃ­sticas -->
            <div class="abilities-section">
                <h3 class="section-subtitle">âš¡ CaracterÃ­sticas</h3>
                <div class="ability-scores-grid">
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸ’ª</div>
                        <div class="ability-name">FUE</div>
                        <div class="ability-value" id="statStr">10</div>
                        <div class="ability-modifier" id="modStr">+0</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸƒ</div>
                        <div class="ability-name">DES</div>
                        <div class="ability-value" id="statDex">10</div>
                        <div class="ability-modifier" id="modDex">+0</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸ›¡ï¸</div>
                        <div class="ability-name">CON</div>
                        <div class="ability-value" id="statCon">10</div>
                        <div class="ability-modifier" id="modCon">+0</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸ§ </div>
                        <div class="ability-name">INT</div>
                        <div class="ability-value" id="statInt">10</div>
                        <div class="ability-modifier" id="modInt">+0</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸ‘ï¸</div>
                        <div class="ability-name">SAB</div>
                        <div class="ability-value" id="statWis">10</div>
                        <div class="ability-modifier" id="modWis">+0</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-icon">ğŸ’¬</div>
                        <div class="ability-name">CAR</div>
                        <div class="ability-value" id="statCha">10</div>
                        <div class="ability-modifier" id="modCha">+0</div>
                    </div>
                </div>
            </div>

            <!-- Combate -->
            <div class="combat-section">
                <h3 class="section-subtitle">âš”ï¸ Combate</h3>
                <div class="combat-stats-grid">
                    <div class="combat-stat">
                        <div class="stat-icon">â¤ï¸</div>
                        <div class="stat-label">Puntos de Golpe</div>
                        <div class="stat-value" id="displayHP">0</div>
                    </div>
                    <div class="combat-stat">
                        <div class="stat-icon">ğŸ›¡ï¸</div>
                        <div class="stat-label">Clase de Armadura</div>
                        <div class="stat-value" id="displayAC">0</div>
                    </div>
                    <div class="combat-stat">
                        <div class="stat-icon">ğŸ‘Ÿ</div>
                        <div class="stat-label">Velocidad</div>
                        <div class="stat-value" id="displaySpeed">30 ft</div>
                    </div>
                    <div class="combat-stat">
                        <div class="stat-icon">âš¡</div>
                        <div class="stat-label">Iniciativa</div>
                        <div class="stat-value" id="displayInit">+0</div>
                    </div>
                </div>
            </div>

            <!-- Salvaciones y habilidades -->
            <div class="info-grid">
                <div class="info-box">
                    <h4>ğŸ¯ Salvaciones</h4>
                    <p id="displaySavingThrows">â€”</p>
                </div>
                <div class="info-box">
                    <h4>ğŸ”§ Habilidades</h4>
                    <p id="displaySkills">â€”</p>
                </div>
            </div>

            <!-- Rasgos, caracterÃ­sticas y equipo -->
            <div class="details-section">
                <div class="detail-panel">
                    <h3 class="section-subtitle">ğŸ‰ Rasgos Raciales</h3>
                    <ul id="racialTraits" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">âš¡ Competencias de Clase</h3>
                    <ul id="classProficiencies" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">âœ¨ CaracterÃ­sticas de Clase</h3>
                    <ul id="classFeatures" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">ğŸ’ Equipo Inicial</h3>
                    <ul id="equipment" class="trait-list"></ul>
                </div>

                <div class="detail-panel background-panel">
                    <h3 class="section-subtitle">ğŸ“œ Trasfondo: <span id="backgroundName"></span></h3>
                    <p><strong>Habilidades:</strong> <span id="backgroundSkills"></span></p>
                    <p><strong>Rasgo:</strong> <span id="backgroundFeature"></span></p>
                    <ul id="backgroundEquipment" class="trait-list"></ul>
                </div>
            </div>

            <!-- Botones de acciÃ³n -->
            <div class="action-buttons">
                <button id="downloadBtn" class="btn btn-primary">
                    ğŸ“„ Descargar PDF
                </button>
                <button id="exportJSONBtn" class="btn btn-secondary">
                    ğŸ’¾ Exportar JSON
                </button>
                <button id="importJSONBtn" class="btn btn-secondary">
                    ğŸ“‚ Importar JSON
                </button>
                <button id="shareBtn" class="btn btn-secondary">
                    ğŸ“¤ Compartir
                </button>
                <button id="mintNFTBtn" class="btn btn-accent">
                    ğŸ¨ Mintear NFT
                </button>
                <button id="historyBtn" class="btn btn-secondary">
                    ğŸ“š Historial
                </button>
                <button id="newCharBtn" class="btn btn-danger">
                    ğŸ†• Nuevo Personaje
                </button>
            </div>

            <input type="file" id="fileImport" accept=".json" style="display: none;">
        </div>

        <!-- SEPARADOR Ã‰PICO -->
        <div class="section-divider">
            <span class="divider-text">ğŸ‰ BESTIARIO ğŸ‰</span>
        </div>

        <!-- GENERADOR DE BESTIAS -->
        <section class="bestiary-section">
            <h2 class="section-title">
                <span class="title-decoration">ğŸ‘¹</span>
                Generador de Criaturas
                <span class="title-decoration">ğŸ‘¹</span>
            </h2>

            <div class="bestiary-controls">
                <div class="filter-grid">
                    <div class="form-group">
                        <label for="creatureTypeFilter">Tipo:</label>
                        <select id="creatureTypeFilter">
                            <option value="">Todos</option>
                            <option value="AberraciÃ³n">AberraciÃ³n</option>
                            <option value="Bestia">Bestia</option>
                            <option value="DragÃ³n">DragÃ³n</option>
                            <option value="Demonio">Demonio</option>
                            <option value="Gigante">Gigante</option>
                            <option value="Humanoide">Humanoide</option>
                            <option value="No-muerto">No-muerto</option>
                            <option value="Monstruosidad">Monstruosidad</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="crFilter">Challenge Rating:</label>
                        <select id="crFilter">
                            <option value="">Todos</option>
                            <option value="0.25">CR 0-1</option>
                            <option value="2">CR 2-3</option>
                            <option value="5">CR 4-5</option>
                            <option value="8">CR 6-8</option>
                            <option value="13">CR 9+</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="environmentFilter">Ambiente:</label>
                        <select id="environmentFilter">
                            <option value="">Todos</option>
                            <option value="Mazmorra">Mazmorra</option>
                            <option value="Bosque">Bosque</option>
                            <option value="MontaÃ±a">MontaÃ±a</option>
                            <option value="Pantano">Pantano</option>
                            <option value="SubterrÃ¡neo">SubterrÃ¡neo</option>
                        </select>
                    </div>
                </div>

                <div class="controls-grid">
                    <button id="generateCreatureBtn" class="btn btn-primary">
                        ğŸ² Generar Criatura
                    </button>
                    <button id="generateFromAPIBtn" class="btn btn-accent">
                        ğŸ“š Desde API D&D 5e
                    </button>
                </div>
            </div>

            <!-- Generador de encuentros -->
            <div class="encounter-generator">
                <h3 class="section-subtitle">âš”ï¸ Generador de Encuentros</h3>
                <div class="encounter-controls">
                    <div class="form-group">
                        <label for="partyLevel">Nivel del Grupo:</label>
                        <input type="number" id="partyLevel" value="5" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label for="partySize">TamaÃ±o del Grupo:</label>
                        <input type="number" id="partySize" value="4" min="1" max="8">
                    </div>
                    <button id="generateEncounterBtn" class="btn btn-primary">
                        âš”ï¸ Generar Encuentro
                    </button>
                </div>

                <div id="encounterPanel" class="encounter-panel hidden">
                    <p class="encounter-xp"><strong>XP del Encuentro:</strong> <span id="encounterXP"></span></p>
                    <div id="encounterList" class="encounter-list"></div>
                </div>
            </div>
        </section>

        <!-- FICHA DE CRIATURA -->
        <div id="creatureSheet" class="creature-sheet hidden">
            <div class="sheet-decoration-top"></div>
            
            <div class="sheet-header">
                <h2 id="creatureName" class="character-name">Nombre Criatura</h2>
                <div class="character-subtitle">
                    <span id="creatureType">Tipo</span>
                    <span class="separator">â€¢</span>
                    <span>CR <span id="creatureCR">0</span></span>
                    <span class="separator">â€¢</span>
                    <span id="creatureXP">0 XP</span>
                </div>
            </div>

            <div class="character-visual">
                <div class="portrait-container">
                    <div class="portrait-frame">
                        <img id="creaturePortrait" src="" alt="Retrato de criatura">
                        <button id="regenCreaturePortrait" class="regen-btn">ğŸ”„</button>
                    </div>
                </div>
            </div>

            <!-- Stats de criatura -->
            <div class="combat-section">
                <h3 class="section-subtitle">âš”ï¸ EstadÃ­sticas de Combate</h3>
                <div class="combat-stats-grid">
                    <div class="combat-stat">
                        <div class="stat-label">CA</div>
                        <div class="stat-value" id="creatureAC">0</div>
                    </div>
                    <div class="combat-stat">
                        <div class="stat-label">HP</div>
                        <div class="stat-value" id="creatureHP">0</div>
                    </div>
                    <div class="combat-stat">
                        <div class="stat-label">Velocidad</div>
                        <div class="stat-value" id="creatureSpeed">30 ft</div>
                    </div>
                </div>
            </div>

            <div class="abilities-section">
                <h3 class="section-subtitle">âš¡ CaracterÃ­sticas</h3>
                <div class="ability-scores-grid">
                    <div class="ability-shield">
                        <div class="ability-name">FUE</div>
                        <div class="ability-value" id="creatureStr">10</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-name">DES</div>
                        <div class="ability-value" id="creatureDex">10</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-name">CON</div>
                        <div class="ability-value" id="creatureCon">10</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-name">INT</div>
                        <div class="ability-value" id="creatureInt">10</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-name">SAB</div>
                        <div class="ability-value" id="creatureWis">10</div>
                    </div>
                    <div class="ability-shield">
                        <div class="ability-name">CAR</div>
                        <div class="ability-value" id="creatureCha">10</div>
                    </div>
                </div>
            </div>

            <div class="details-section">
                <div class="detail-panel">
                    <h3 class="section-subtitle">ğŸ”§ Habilidades</h3>
                    <ul id="creatureSkills" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">âœ¨ Rasgos Especiales</h3>
                    <ul id="creatureTraits" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">âš”ï¸ Acciones</h3>
                    <ul id="creatureActions" class="trait-list"></ul>
                </div>

                <div id="legendarySection" class="detail-panel hidden">
                    <h3 class="section-subtitle">ğŸ‘‘ Acciones Legendarias</h3>
                    <ul id="creatureLegendaryActions" class="trait-list"></ul>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">ğŸ›¡ï¸ Defensas</h3>
                    <p id="creatureDefenses">â€”</p>
                </div>

                <div class="detail-panel">
                    <h3 class="section-subtitle">ğŸŒ Ambiente</h3>
                    <p id="creatureEnvironment">â€”</p>
                </div>
            </div>

            <div class="action-buttons">
                <button id="newCreatureBtn" class="btn btn-danger">
                    ğŸ†• Nueva Criatura
                </button>
            </div>
        </div>

    </div>

    <!-- MODAL DE HISTORIAL -->
    <div id="historyModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">âœ–ï¸</span>
            <h2>ğŸ“š Historial de Personajes</h2>
            <div id="historyList" class="history-list"></div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="main-footer">
        <p>âš”ï¸ D&D Character Forge Â© 2025 ğŸ‰</p>
        <p>Creado con â¤ï¸ para la comunidad de Dragones y Mazmorras</p>
        <button id="toggleTheme" class="theme-toggle">ğŸŒ™ Modo Oscuro</button>
    </footer>

    <!-- SCRIPTS -->
    <script src="data/dnd-data.js"></script>
    <script src="data/bestiary.js"></script>
    <script src="app.js"></script>
</body>
</html>
